<!DOCTYPE html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content=" ">
<title>Introduction | vSphere Docker Volume Service</title>
<link rel="stylesheet" href="css/syntax.css">


<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="css/modern-business.css">
<link rel="stylesheet" href="css/lavish-bootstrap.css">
<link rel="stylesheet" href="css/customstyles.css">
<link rel="stylesheet" href="css/theme-blue.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<link rel="shortcut icon" href="images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="" href="http://localhost:4000feed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="index.html">&nbsp;<span class="projectTitle"> vSphere Docker Volume Service</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- entries without drop-downs appear here -->
                
                
                
                <li><a href="http:www.vmware.comin.html">VMWare Home</a></li>
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Social Media<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="https://www.youtube.com/user/vmwaretv" target="_blank">VMWare on Youtube</a></li>
                        
                        
                        
                        <li><a href="https://communities.vmware.com/community/vmtn/foreign-language-forums" target="_blank">Communities</a></li>
                        
                        
                        
                        <li><a href="https://twitter.com/VMwareIN" target="_blank">Twitter</a></li>
                        
                        
                    </ul>
                </li>
                
                
                
			<li>



  <a class="email" title="Submit feedback" href="#" onclick="javascript:window.location='mailto:tomjohnson1492@gmail.com?subject=Jekyll documentation theme feedback&body=I have some feedback about the Introduction page: ' + window.location.href;"><i class="fa fa-envelope-o"></i> Feedback</a>

</li>

		
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: 'search.json',
                                searchResultTemplate: '<li><a href="{url}" title="Introduction">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
    <div class="col-lg-12">&nbsp;</div>
    <!-- Content Row -->
    <div class="row">
        <!-- Sidebar Column -->
        <div class="col-md-3">

          












<ul id="mysidebar" class="nav">
    <li class="sidebarTitle">Menu </li>
    
    
    
    <li>
        <a href="#">Get Started</a>
        <ul>
            
            
            
            <li><a href="index.html">Welcome to Docker</a></li>
            
            
            
            
            
            
            <li><a href="tenancy.html">Tenancy</a></li>
            
            
            
            
            
            
            <li><a href="admin-cli.html">Admin CLI</a></li>
            
            
            
            
            
            
            <li><a href="install.html">Installation</a></li>
            
            
            
            
            
            
            <li><a href="vcenter.html">vCenter</a></li>
            
            
            
            
            
            
            <li><a href="vsphere-overview.html">vSphere Overview</a></li>
            
            
            
            
            
            
            <li><a href="vsanpolicy.html">vSAN Policy</a></li>
            
            
            
            
            
            
            <li><a href="photon-overview.html">Photon Overview</a></li>
            
            
            
            
            
            
            <li><a href="docker-plugin-drivers.html">Docker Plugin Drivers</a></li>
            
            
            
            
            
            
            <li><a href="docker-volume-cli.html">Docker Volume CLI</a></li>
            
            
            
            
        </ul>
        
        
        
        <!-- if you aren't using the accordion, uncomment this block:
           <p class="external">
               <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
           </p>
           -->
    </li>
</ul>
</div>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

    <!-- Content Column -->
    <div class="col-md-9">
        <div class="post-header">
   <h1 class="post-title-main">Introduction</h1>
</div>



<div class="post-content">

   

    
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2,h3,h4' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 10);
  return false
})
  
});
</script>

<div id="toc"></div>

    


    

    <a target="_blank" href="https://github.com/tomjohnson1492/documentation-theme-jekyll/blob/gh-pages/pages//pages/product1/admin-cli.md" class="btn btn-default githubEditButton" role="button"><i class="fa fa-github fa-lg"></i> Edit me</a>

    

  <h1 id="introduction">Introduction</h1>

<p>With the vSphere Docker Volume Service, each ESXi host manages multiple VMs, with
each of them acting as a Docker host. The Docker engine on these hosts communicates with the Docker
volume service to create and delete virtual disks (VMDKs), as well as mounts them as Docker
volumes. These virtual disks may live on any datastore accessible to the ESXi host and are managed
by the Docker user via the Docker CLI. However, the Docker CLI is limited in what visibility it can
provide to the user. Furthermore, it is desirable that an administrator be able to get a global view
of all virtual disks created and in use on the host.  For these reasons, an admin CLI has been
created that runs on the ESXi host and that provides access to information not visible from the
Docker CLI.</p>

<p>The admin cli also enables ESX admins to implement tenancy.</p>

<p>The remainder of this document will describe each admin CLI command and provide examples
of their usage.</p>

<h2 id="vm-group">Vm-group</h2>

<h3 id="help">Help</h3>
<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="o">[</span>root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group -h
usage: vmdkops_admin.py vm-group <span class="o">[</span>-h] <span class="o">{</span>create,vm,update,access,ls,rm<span class="o">}</span> ...

positional arguments:
  <span class="o">{</span>create,vm,update,access,ls,rm<span class="o">}</span>
    create              Create a new vm-group
    vm                  Add, removes and lists VMs <span class="k">in </span>a vm-group
    update              Update an existing vm-group
    access              Add or remove Datastore access and quotas <span class="k">for </span>a vm-
                        group
    ls                  List vm-groups and the VMs they are applied to
    rm                  Delete a vm-group

optional arguments:
  -h, --help            show this <span class="nb">help </span>message and <span class="nb">exit</span>
</code></pre>
</div>

<h3 id="create">Create</h3>
<p>A vm-group named “_DEFAULT” will be created automatically post install.</p>

<p>Creates a new named vm-group and optionally assigns VMs. Valid vm-group name is only allowed to be “[a-zA-Z0-9<em>][a-zA-Z0-9</em>.-]*”</p>

<p>Sample:
<code class="highlighter-rouge">
[root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group create --name=vm-group1
vm-group create succeeded
[root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group ls
Uuid                                  Name       Description                 Default_datastore  VM_list
------------------------------------  ---------  --------------------------  -----------------  -------
11111111-1111-1111-1111-111111111111  _DEFAULT   This is a default vm-group
1ddb5b46-6a9f-4649-8e48-c47039905752  vm-group1
</code></p>

<p>The vm-group to VM association can be done at create time.</p>

<p>Sample:
```
[root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group create –name=vm-group1 –vm-list=photon6
vm-group create succeeded
[root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group ls
Uuid                                  Name       Description                 Default_datastore  VM_list
————————————  ———  ————————–  —————–  ——–
11111111-1111-1111-1111-111111111111  _DEFAULT   This is a default vm-group
035ddfb7-349b-4ba1-8abf-e77a430d5098  vm-group1                                                 photon6</p>

<div class="highlighter-rouge"><pre class="highlight"><code>
#### Help
</code></pre>
</div>
<p>[root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group create -h
usage: vmdkops_admin.py vm-group create [-h] –name NAME
                                        [–description DESCRIPTION]
                                        [–vm-list vm1, vm2, …]</p>

<p>optional arguments:
  -h, –help            show this help message and exit
  –name NAME           The name of the vm-group
  –description DESCRIPTION
                        The description of the vm-group
  –vm-list vm1, vm2, …
                        A list of VM names to place in this vm-group</p>

<div class="highlighter-rouge"><pre class="highlight"><code>### List
List existing vm-groups, the datastores vm-groups have access to and the VMs assigned.
</code></pre>
</div>
<p>[root@localhost:~] usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group ls
Uuid                                  Name       Description                 Default_datastore  VM_list
————————————  ———  ————————–  —————–  ——–
11111111-1111-1111-1111-111111111111  _DEFAULT   This is a default vm-group
035ddfb7-349b-4ba1-8abf-e77a430d5098  vm-group1                                                 photon6</p>

<div class="highlighter-rouge"><pre class="highlight"><code>
#### Help
</code></pre>
</div>
<p>[root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group ls -h
usage: vmdkops_admin.py vm-group ls [-h]</p>

<p>optional arguments:
  -h, –help  show this help message and exit
```</p>

<h3 id="update">Update</h3>
<p>Update existing vm-group. This command allows to update “Description” and “Default_datastore” fields, or rename an existing vm-group.
Sample:
```
[root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group ls
Uuid                                  Name       Description                 Default_datastore  VM_list
————————————  ———  ————————–  —————–  ——–
11111111-1111-1111-1111-111111111111  _DEFAULT   This is a default vm-group
035ddfb7-349b-4ba1-8abf-e77a430d5098  vm-group1                                                 photon6</p>

<p>[root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group update –name=vm-group1 –description=”New description of vm-group1” –new-name=new-vm-group1 –default-datastore=datastore1
vm-group modify succeeded
[root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group ls
Uuid                                  Name           Description                   Default_datastore  VM_list
————————————  ————-  —————————-  —————–  ——–
11111111-1111-1111-1111-111111111111  _DEFAULT       This is a default vm-group
035ddfb7-349b-4ba1-8abf-e77a430d5098  new-vm-group1  New description of vm-group1  datastore1         photon6</p>

<div class="highlighter-rouge"><pre class="highlight"><code>
#### Help
</code></pre>
</div>
<p>[root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group  update -h
usage: vmdkops_admin.py vm-group update [-h] –name NAME
                                        [–default-datastore DEFAULT_DATASTORE]
                                        [–description DESCRIPTION]
                                        [–new-name NEW_NAME]</p>

<p>optional arguments:
  -h, –help            show this help message and exit
  –name NAME           The name of the vm-group
  –default-datastore DEFAULT_DATASTORE
                        The name of the datastore to be used by default for
                        volumes placement
  –description DESCRIPTION
                        The new description of the vm-group
  –new-name NEW_NAME   The new name of the vm-group</p>

<div class="highlighter-rouge"><pre class="highlight"><code>
### Remove
Remove a vm-group, optionally all volumes for a vm-group can be removed as well.

Sample:
</code></pre>
</div>
<p>[root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group rm –name=vm-group1 –remove-volumes
All Volumes will be removed
vm-group rm succeeded</p>

<p>[root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group ls
Uuid                                  Name      Description                 Default_datastore  VM_list
————————————  ——–  ————————–  —————–  ——-
11111111-1111-1111-1111-111111111111  _DEFAULT  This is a default vm-group
```</p>

<h4 id="help-1">Help</h4>
<div class="highlighter-rouge"><pre class="highlight"><code>[root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group rm -h
usage: vmdkops_admin.py vm-group rm [-h] --name NAME [--remove-volumes]

optional arguments:
  -h, --help        show this help message and exit
  --name NAME       The name of the vm-group
  --remove-volumes  BE CAREFUL: Removes this vm-group volumes when removing a
                    vm-group

</code></pre>
</div>

<h3 id="virtual-machine">Virtual Machine</h3>

<h4 id="add">Add</h4>
<p>Add a VM to a vm-group. A VM can only access the datastores for the vm-group it is assigned to.
VMs can be assigned to only one vm-group at a time.
```
[root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group ls
Uuid                                  Name       Description                 Default_datastore  VM_list
————————————  ———  ————————–  —————–  ——–
11111111-1111-1111-1111-111111111111  _DEFAULT   This is a default vm-group
6d810c66-ffc7-47c8-8870-72114f86c2cf  vm-group1                                                 photon6</p>

<p>[root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group vm add –name=vm-group1 –vm-list=photon7
vm-group vm add succeeded</p>

<div class="highlighter-rouge"><pre class="highlight"><code>
#### List
</code></pre>
</div>
<p>[root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group vm ls –name=vm-group1
Uuid                                  Name
————————————  ——–
564d5849-b135-1259-cc73-d2d3aa1d9b8c  photon6
564d99a2-4097-9966-579f-3dc4082b10c9  photon7
```</p>

<h4 id="remove">Remove</h4>
<p>Remove a VM from a vm-group’s list of VMs. VM will no longer be able to access the volumes created for the vm-group.
```
[root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group vm rm –name=vm-group1 –vm-list=photon7
vm-group vm rm succeeded
[root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group vm ls –name=vm-group1
Uuid                                  Name
————————————  ——–
564d5849-b135-1259-cc73-d2d3aa1d9b8c  photon6</p>

<div class="highlighter-rouge"><pre class="highlight"><code>
### Replace
Replace VMs from a vm-group's list of VMs. VMs which are replaced will no longer be able to access the volumes created for the vm-group.
</code></pre>
</div>
<p>[root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group vm ls –name=vm-group1
Uuid                                  Name
————————————  ——–
564d5849-b135-1259-cc73-d2d3aa1d9b8c  photon6</p>

<p>[root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group vm replace –name=vm-group1 –vm-list=photon7
vm-group vm replace succeeded</p>

<p>[root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group vm ls –name=vm-group1
Uuid                                  Name
————————————  ——–
564d99a2-4097-9966-579f-3dc4082b10c9  photon7
```</p>

<h4 id="help-2">Help</h4>
<div class="highlighter-rouge"><pre class="highlight"><code>[root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group vm -h
usage: vmdkops_admin.py vm-group vm [-h] {rm,add,ls,replace} ...

positional arguments:
  {rm,add,ls,replace}
    rm                 Remove VM(s) from a vm-group
    add                Add a VM(s) to a vm-group
    ls                 list VMs in a vm-group
    replace            Replace VM(s) for a vm-group

optional arguments:
  -h, --help           show this help message and exit

</code></pre>
</div>

<h3 id="access">Access</h3>
<p>Change the access control for a vm-group.
This includes ability to grant privileges &amp; set resource consumption limits for a datastore.</p>

<h4 id="help-3">Help</h4>
<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="o">[</span>root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group access -h
usage: vmdkops_admin.py vm-group access <span class="o">[</span>-h] <span class="o">{</span>rm,add,set,ls<span class="o">}</span> ...

positional arguments:
  <span class="o">{</span>rm,add,set,ls<span class="o">}</span>
    rm             Remove all access to a datastore <span class="k">for </span>a vm-group
    add            Add a datastore access <span class="k">for </span>a vm-group
    <span class="nb">set            </span>Modify datastore access <span class="k">for </span>a vm-group
    ls             List all access info <span class="k">for </span>a vm-group

optional arguments:
  -h, --help       show this <span class="nb">help </span>message and <span class="nb">exit</span>

</code></pre>
</div>

<h4 id="add-1">Add</h4>
<p>Grants datastore access to a vm-group.</p>

<p>The datastore will be automatically set as “default_datastore” for the vm-group
when you grant first datastore access for a vm-group.</p>

<p>Sample:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="o">[</span>root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group access add --name<span class="o">=</span>vm-group1 --datastore<span class="o">=</span>datastore1  --volume-maxsize<span class="o">=</span>500MB --volume-totalsize<span class="o">=</span>1GB
vm-group access add succeeded

<span class="o">[</span>root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group ls
Uuid                                  Name       Description                 Default_datastore  VM_list
------------------------------------  ---------  --------------------------  -----------------  -------
11111111-1111-1111-1111-111111111111  _DEFAULT   This is a default vm-group
6d810c66-ffc7-47c8-8870-72114f86c2cf  vm-group1                              datastore1         photon7
</code></pre>
</div>

<p>The datastore will be set as “default_datastore” for the vm-group when you grant datastore access for a vm-group with “–default-datastore” flag.</p>

<p>Sample:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="o">[</span>root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group access add --name<span class="o">=</span>vm-group1 --datastore<span class="o">=</span>datastore2  --allow-create --default-datastore --volume-maxsize<span class="o">=</span>500MB --volume-totalsize<span class="o">=</span>1GB
vm-group access add succeeded

<span class="o">[</span>root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group access ls --name<span class="o">=</span>vm-group1
Datastore   Allow_create  Max_volume_size  Total_size
----------  ------------  ---------------  ----------
datastore1  False         500.00MB         1.00GB
datastore2  True          500.00MB         1.00GB

<span class="o">[</span>root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group ls
Uuid                                  Name       Description                 Default_datastore  VM_list
------------------------------------  ---------  --------------------------  -----------------  -------
11111111-1111-1111-1111-111111111111  _DEFAULT   This is a default vm-group
6d810c66-ffc7-47c8-8870-72114f86c2cf  vm-group1                              datastore2         photon7

</code></pre>
</div>

<p>By default no “allow_create” right is given</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="o">[</span>root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group access add --name<span class="o">=</span>vm-group1 --datastore<span class="o">=</span>datastore1  --volume-maxsize<span class="o">=</span>500MB --volume-totalsize<span class="o">=</span>1GB
vm-group access add succeeded

<span class="o">[</span>root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group access ls --name<span class="o">=</span>vm-group1
Datastore   Allow_create  Max_volume_size  Total_size
----------  ------------  ---------------  ----------
datastore1  False         500.00MB         1.00GB
</code></pre>
</div>

<p>“allow_create” right is given when you run the command with “–allow-create” flag.
```bash
[root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group access add –name=vm-group1 –datastore=datastore2  –allow-create –default-datastore –volume-maxsize=500MB –volume-totalsize=1GB
vm-group access add succeeded</p>

<p>[root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group access ls –name=vm-group1
Datastore   Allow_create  Max_volume_size  Total_size
———-  ————  —————  ———-
datastore1  False         500.00MB         1.00GB
datastore2  True          500.00MB         1.00GB
```</p>

<h5 id="help-4">Help</h5>
<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="o">[</span>root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group access add -h
usage: vmdkops_admin.py vm-group access add <span class="o">[</span>-h]
                                            <span class="o">[</span>--volume-totalsize Num<span class="o">{</span>MB,GB,TB<span class="o">}</span> - e.g. 2TB]
                                            <span class="o">[</span>--volume-maxsize Num<span class="o">{</span>MB,GB,TB<span class="o">}</span> - e.g. 2TB]
                                            <span class="o">[</span>--allow-create] --name NAME
                                            <span class="o">[</span>--default-datastore] --datastore
                                            DATASTORE

optional arguments:
  -h, --help            show this <span class="nb">help </span>message and <span class="nb">exit</span>
  --volume-totalsize Num<span class="o">{</span>MB,GB,TB<span class="o">}</span> - e.g. 2TB
                        Maximum total size of all volume that can be created
                        on the datastore <span class="k">for </span>this vm-group
  --volume-maxsize Num<span class="o">{</span>MB,GB,TB<span class="o">}</span> - e.g. 2TB
                        Maximum size of the volume that can be created
  --allow-create        Allow create and delete on datastore <span class="k">if </span><span class="nb">set</span>
  --name NAME           The name of the vm-group
  --default-datastore   Mark datastore as a default datastore <span class="k">for </span>this vm-
                        group
  --datastore DATASTORE
                        Datastore which access is controlled


</code></pre>
</div>

<h4 id="list">List</h4>
<p>List the current access control granted to a vm-group.</p>

<p>When displaying the result keep in mind:</p>

<ul>
  <li>For capacity Unset indicates no limits</li>
</ul>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="o">[</span>root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group access ls --name<span class="o">=</span>vm-group1
Datastore   Allow_create  Max_volume_size  Total_size
----------  ------------  ---------------  ----------
datastore1  False         500.00MB         1.00GB
datastore2  True          500.00MB         1.00GB
</code></pre>
</div>

<h5 id="help-5">Help</h5>
<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="o">[</span>root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group access ls -h
usage: vmdkops_admin.py vm-group access ls <span class="o">[</span>-h] --name NAME

optional arguments:
  -h, --help   show this <span class="nb">help </span>message and <span class="nb">exit</span>
  --name NAME  The name of the vm-group

</code></pre>
</div>

<h4 id="remove-1">Remove</h4>
<p>Remove access to a datastore for a vm-group.
```bash
[root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group access ls –name=vm-group1
Datastore   Allow_create  Max_volume_size  Total_size
———-  ————  —————  ———-
datastore1  False         500.00MB         1.00GB
datastore2  True          500.00MB         1.00GB</p>

<p>[root@localhost:~]  /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group  access rm –name=vm-group1 –datastore=datastore1
vm-group access rm succeeded</p>

<p>[root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group access ls –name=vm-group1
Datastore   Allow_create  Max_volume_size  Total_size
———-  ————  —————  ———-
datastore2  True          500.00MB         1.00GB
```</p>

<h5 id="help-6">Help</h5>
<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="o">[</span>root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group  access rm -h
usage: vmdkops_admin.py vm-group access rm <span class="o">[</span>-h] --name NAME --datastore
                                           DATASTORE

optional arguments:
  -h, --help            show this <span class="nb">help </span>message and <span class="nb">exit</span>
  --name NAME           The name of the vm-group
  --datastore DATASTORE
                        Datstore which access is controlled

</code></pre>
</div>

<h4 id="set">Set</h4>
<p>Set command allows to change the existing access control in place for a vm-group.</p>

<p>Sample:</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="o">[</span>root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group access ls --name<span class="o">=</span>vm-group1
Datastore   Allow_create  Max_volume_size  Total_size
----------  ------------  ---------------  ----------
datastore1  False         500.00MB         1.00GB

<span class="o">[</span>root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group access <span class="nb">set</span> --name<span class="o">=</span>vm-group1 --datastore<span class="o">=</span>datastore1 --allow-create<span class="o">=</span>True  --volume-maxsize<span class="o">=</span>1000MB --volume-totalsize<span class="o">=</span>2GB
vm-group access <span class="nb">set </span>succeeded

<span class="o">[</span>root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group access ls
usage: vmdkops_admin.py vm-group access ls <span class="o">[</span>-h] --name NAME
vmdkops_admin.py vm-group access ls: error: argument --name is required
<span class="o">[</span>root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group access ls --name<span class="o">=</span>vm-group1
Datastore   Allow_create  Max_volume_size  Total_size
----------  ------------  ---------------  ----------
datastore1  True          1000.00MB        2.00GB



</code></pre>
</div>

<h5 id="help-7">Help</h5>
<div class="highlighter-rouge"><pre class="highlight"><code>[root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py vm-group access set -h
usage: vmdkops_admin.py vm-group access set [-h]
                                            [--volume-totalsize Num{MB,GB,TB} - e.g. 2TB]
                                            --name NAME
                                            [--volume-maxsize Num{MB,GB,TB} - e.g. 2TB]
                                            [--allow-create Value{True|False} - e.g. True]
                                            --datastore DATASTORE

optional arguments:
  -h, --help            show this help message and exit
  --volume-totalsize Num{MB,GB,TB} - e.g. 2TB
                        Maximum total size of all volume that can be created
                        on the datastore for this vm-group
  --name NAME           The name of the vm-group
  --volume-maxsize Num{MB,GB,TB} - e.g. 2TB
                        Maximum size of the volume that can be created
  --allow-create Value{True|False} - e.g. True
                        Allow create and delete on datastore if set to True;
                        disallow create and delete on datastore if set to
                        False
  --datastore DATASTORE
                        Datastore name

</code></pre>
</div>

<h2 id="volume">Volume</h2>

<h4 id="help-8">Help</h4>
<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="o">[</span>root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py volume ls -h
usage: vmdkops_admin.py volume ls <span class="o">[</span>-h] <span class="o">[</span>-c Col1,Col2,...]

optional arguments:
  -h, --help        show this <span class="nb">help </span>message and <span class="nb">exit</span>
  -c Col1,Col2,...  Display selected columns: Choices <span class="o">=</span> <span class="o">[</span><span class="s1">'volume'</span>,
                    <span class="s1">'datastore'</span>, <span class="s1">'created-by'</span>, <span class="s1">'created'</span>, <span class="s1">'attached-to'</span>,
                    <span class="s1">'policy'</span>, <span class="s1">'capacity'</span>, <span class="s1">'used'</span><span class="o">]</span>
</code></pre>
</div>

<h4 id="list-all">List All</h4>
<p>List all properties for all Docker volumes that exist on datastores accessible to the host.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="o">[</span>root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py volume ls
Volume  Datastore   VM-Group   Capacity  Used  Filesystem  Policy  Disk Format  Attached-to  Access      Attach-as               Created By  Created Date
------  ----------  ---------  --------  ----  ----------  ------  -----------  -----------  ----------  ----------------------  ----------  ------------------------
vol1    datastore1  _DEFAULT   100MB     13MB  ext4        N/A     thin         detached     <span class="nb">read</span>-write  independent_persistent  photon-6    Sun Sep 11 21:36:13 2016
vol12   datastore1  _DEFAULT   100MB     13MB  ext4        N/A     thin         detached     <span class="nb">read</span>-write  independent_persistent  photon-6    Sun Sep 11 22:29:39 2016
vol1    datastore1  vm-group1  100MB     13MB  ext4        N/A     thin         detached     <span class="nb">read</span>-write  independent_persistent  photon-6    Sun Sep 11 22:48:13 2016
vol2    datastore1  vm-group1  100MB     13MB  ext4        N/A     thin         detached     <span class="nb">read</span>-write  independent_persistent  photon-6    Sun Sep 11 22:48:23 2016
</code></pre>
</div>

<p>Note that the <code class="highlighter-rouge">Policy</code> column shows the named VSAN storage policy created with the same tool
(vmdkops_admin.py).  Since these example virtual disks live on a VMFS datastore they do not have a storage
policy and show up as `N/A’.</p>

<p>Note that the <code class="highlighter-rouge">VM-Group</code> column shows the vm-group by which the volume was created. If the vm-group which created the volume has been removed, the <code class="highlighter-rouge">VM-Group</code> column shows up as ‘N/A’. See the following example:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="o">[</span>root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py volume ls
Volume  Datastore   VM-Group  Capacity  Used  Filesystem  Policy  Disk Format  Attached-to  Access      Attach-as               Created By  Created Date
------  ----------  --------  --------  ----  ----------  ------  -----------  -----------  ----------  ----------------------  ----------  ------------------------
vol1    datastore1  _DEFAULT  100MB     13MB  ext4        N/A     thin         detached     <span class="nb">read</span>-write  independent_persistent  photon-6    Sun Sep 11 21:36:13 2016
vol12   datastore1  _DEFAULT  100MB     13MB  ext4        N/A     thin         detached     <span class="nb">read</span>-write  independent_persistent  photon-6    Sun Sep 11 22:29:39 2016
vol1    datastore1  N/A       100MB     13MB  ext4        N/A     thin         detached     <span class="nb">read</span>-write  independent_persistent  photon-6    Sun Sep 11 22:48:13 2016
vol2    datastore1  N/A       100MB     13MB  ext4        N/A     thin         detached     <span class="nb">read</span>-write  independent_persistent  photon-6    Sun Sep 11 22:48:23 2016
</code></pre>
</div>

<h4 id="list-selected-columns">List selected columns</h4>

<p>Show only the selected columns.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="o">[</span>root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py volume ls -c volume,datastore,attached-to
Volume     Datastore   Attached To VM
---------  ----------  --------------
large-vol  datastore1  detached
vol        datastore1  detached
</code></pre>
</div>

<p>Note that the that the choices are given in a comma separated list with no spaces, and are shown in
the help given above with <code class="highlighter-rouge">vmdkops_admin ls -h</code>.</p>

<h3 id="set-1">Set</h3>
<p>Modify attribute settings on a given volume. The volume is identified by its name, vm-group_name which the volume belongs to and datastore,
for example if the volume name is <code class="highlighter-rouge">container-vol</code> then the volume is specified as “container-vol@datastore-name”.
The attributes to set/modify are specified as a comma separated list as “<attr1>=<value>, <attr2>=<value>....". For example,
a command line would look like this.</value></attr2></value></attr1></p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>vmdkops-admin <span class="nb">set</span> --volume<span class="o">=</span>&lt;volume@datastore&gt; --vm-group<span class="o">=</span>&lt;vm-group_name&gt; --options<span class="o">=</span><span class="s2">"&lt;attr1&gt;=&lt;value&gt;, &lt;attr2&gt;=&lt;value&gt;, ..."</span>
</code></pre>
</div>

<p>The volume attributes are set and take effect only the next time the volume attached to a VM. The changes do not impact any VM
thats currently using the volume. For the present, only the “access” attribute is supported to be modified via this command, and
can be set to either of the allowed values “read-only” or “read-write”.</p>

<p>Set command allows the admin to enforce a volume to be read-only.
This removes the need to depend on <a href="https://docs.docker.com/engine/tutorials/dockervolumes/">Docker’s run command options for volume access</a> (<code class="highlighter-rouge">docker run -v /vol:/vol:ro</code>).</p>

<p>A sample use case:</p>

<ol>
  <li>Create a volume, attach to a container (default is read-write).</li>
  <li>Master the volume with libraries commonly used by the target application (or a cluster of apps that form a docker app bundle).</li>
  <li>Use admin CLI to flip the access attribute to read-only.</li>
  <li>Make those libraries available to the containers in the app bundle and they can all share the same libraries.</li>
</ol>

<p>The container images themselves can be smaller as they share the libs and possibly binaries from read-only volumes.</p>

<p>Example:
```bash
[root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py volume ls
Volume  Datastore   VM-Group  Capacity  Used  Filesystem  Policy  Disk Format  Attached-to  Access      Attach-as               Created By  Created Date
——  ———-  ——–  ——–  —-  ———-  ——  ———–  ———–  ———-  ———————-  ———-  ————————
vol1    datastore1  _DEFAULT  100MB     13MB  ext4        N/A     thin         detached     read-write  independent_persistent  photon-6    Sun Sep 11 21:36:13 2016
vol12   datastore1  _DEFAULT  100MB     13MB  ext4        N/A     thin         detached     read-write  independent_persistent  photon-6    Sun Sep 11 22:29:39 2016
vol1    datastore1  N/A       100MB     13MB  ext4        N/A     thin         detached     read-write  independent_persistent  photon-6    Sun Sep 11 22:48:13 2016
vol2    datastore1  N/A       100MB     13MB  ext4        N/A     thin         detached     read-write  independent_persistent  photon-6    Sun Sep 11 22:48:23 2016</p>

<p>[root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py volume set –volume=vol1@datastore1 –vm-group=_DEFAULT –options=”access=read-only”
Successfully updated settings for : vol1@datastore1</p>

<p>[root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py volume ls
Volume  Datastore   VM-Group  Capacity  Used  Filesystem  Policy  Disk Format  Attached-to  Access      Attach-as               Created By  Created Date
——  ———-  ——–  ——–  —-  ———-  ——  ———–  ———–  ———-  ———————-  ———-  ————————
vol1    datastore1  _DEFAULT  100MB     13MB  ext4        N/A     thin         detached     read-only   independent_persistent  photon-6    Sun Sep 11 21:36:13 2016
vol12   datastore1  _DEFAULT  100MB     13MB  ext4        N/A     thin         detached     read-write  independent_persistent  photon-6    Sun Sep 11 22:29:39 2016
vol1    datastore1  N/A       100MB     13MB  ext4        N/A     thin         detached     read-write  independent_persistent  photon-6    Sun Sep 11 22:48:13 2016
vol2    datastore1  N/A       100MB     13MB  ext4        N/A     thin         detached     read-write  independent_persistent  photon-6    Sun Sep 11 22:48:23 2016</p>

<div class="highlighter-rouge"><pre class="highlight"><code>

## Policy

Create, configure and show the VSAN policy names and their corresponding VSAN policy strings. Also show whether or not they are in use.

#### Help
```bash
[root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py policy -h
usage: vmdkops_admin.py policy [-h] {rm,create,ls,update} ...

positional arguments:
  {rm,create,ls,update}
    rm                  Remove a storage policy
    create              Create a storage policy
    ls                  List storage policies and volumes using those policies
    update              Update the definition of a storage policy and all VSAN
                        objects using that policy

optional arguments:
  -h, --help            show this help message and exit
</code></pre>
</div>

<h4 id="create-1">Create</h4>

<p>Create a VSAN storage policy.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="o">[</span>root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py policy create --name some-policy --content <span class="s1">'(("proportionalCapacity" i0)("hostFailuresToTolerate" i0)'</span>
Successfully created policy: some-policy
</code></pre>
</div>

<p>Note that the VSAN storage policy string given with <code class="highlighter-rouge">--content</code> is a standard VSAN storage policy
string.  Please refer to the <a href="https://pubs.vmware.com/vsphere-60/index.jsp?topic=%2Fcom.vmware.vcli.ref.doc%2Fesxcli_vsan.html">VSAN documentation</a>
for storage policy options.</p>

<h4 id="list-1">List</h4>

<p>List all VSAN storage policies.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="o">[</span>root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py policy ls
Policy Name  Policy Content                                             Active
-----------  ---------------------------------------------------------  ------
some-policy  <span class="o">((</span><span class="s2">"proportionalCapacity"</span> i0<span class="o">)(</span><span class="s2">"hostFailuresToTolerate"</span> i0<span class="o">)</span>  Unused
</code></pre>
</div>

<p>When creating a virtual disk using <code class="highlighter-rouge">docker volume create</code>, the policy name should be given with the <code class="highlighter-rouge">-o</code>
option such as <code class="highlighter-rouge">docker volume create --driver=vsphere --name=some-vol -o vsan-policy-name=some-policy</code>.
The number of virtual disks using the policy will then show up in the <code class="highlighter-rouge">Active</code> column.</p>

<h4 id="update-1">Update</h4>

<p>Update a VSAN storage policy.</p>

<p>This command will update a VSAN storage policy for all virtual disks currently using this policy. If
the command fails, the number of virtual disks that were successfully updated and the number that
failed to update will be shown. The names of the virtual disks that failed to update will be logged
so that manual action can be taken.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="o">[</span>root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py policy update --name some-policy --content <span class="s1">'(("proportionalCapacity" i1)'</span>
This operation may take a <span class="k">while</span>. Please be patient.
Successfully updated policy: some-policy
</code></pre>
</div>

<h4 id="remove-2">Remove</h4>

<p>Remove a VSAN storage policy. Note that a storage policy cannot be removed if it is currently in use
by one or more virtual disks.</p>

<p>The ability to list which virtual disks are using a specific storage policy, change storage policies
for a virtual disk, and reset virtual disks to the default storage policy is a necessary
enhancement tracked <a href="https://github.com/vmware/docker-volume-vsphere/issues/577">here</a>.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="o">[</span>root@localhost:~] /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py policy rm --name<span class="o">=</span>some-policy
Successfully removed policy: some-policy
</code></pre>
</div>
<p>## Status</p>

<p>Show config and run-time information about the service.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="o">[</span>root@localhost:~]  /usr/lib/vmware/vmdkops/bin/vmdkops_admin.py status
 Version: 1.0.0-0.0.1
 Status: Running
 Pid: 161104
 Port: 1019
 LogConfigFile: /etc/vmware/vmdkops/log_config.json
 LogFile: /var/log/vmware/vmdk_ops.log
 LogLevel: INFO
</code></pre>
</div>


    <div class="tags">
        
    </div>

    

</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               &copy;2017 VMWare. All rights reserved. <br />
 Site last generated: Mar 23, 2017 <br />
<p><img src="images/company_logo.png" alt="Company logo"/></p>
                </div>
            </div>
</footer>


    </div>
    <!-- /.row -->
</div>
<!-- /.container -->
    </div>

</body>

</html>